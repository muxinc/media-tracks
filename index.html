<!DOCTYPE html>
<html>
  <head>
    <title>Media Tracks</title>
  </head>
  <body>
    <style>
      video {
        width: 100%;
        aspect-ratio: 16 / 9;
        max-width: 960px;
      }
    </style>

    <video
      crossorigin
      controls
      muted
    ></video>

    <script type="module">
      // Importing this module polyfills the native HTMLMediaElement API.
      import './dist/index.js';
      import 'https://cdn.jsdelivr.net/npm/hls.js@1';

      const myVideo = document.querySelector('video');
      let videoSrc = 'https://playertest.longtailvideo.com/adaptive/elephants_dream_v4/index.m3u8';

      if (Hls.isSupported()) {
        var hls = new Hls();
        hls.loadSource(videoSrc);
        hls.attachMedia(myVideo);
      } else if (myVideo.canPlayType('application/vnd.apple.mpegurl')) {
        myVideo.src = videoSrc;
      }

      myVideo.addEventListener('emptied', (e) => {
        console.log(e.type, performance.now());
      });

      myVideo.addEventListener('loadstart', (e) => {
        console.log(e.type, performance.now());
      });

      myVideo.addEventListener('loadedmetadata', (e) => {
        console.log(e.type, performance.now());
      });

      myVideo.addEventListener('loadeddata', (e) => {
        console.log(e.type, performance.now());
      });

      myVideo.addEventListener('resize', (e) => {
        console.log(e.type, performance.now());
      });

      myVideo.addEventListener('canplay', (e) => {
        console.log(e.type, performance.now());
      });

      myVideo.videoTracks.addEventListener('change', (e) => {
        console.log(e.type, performance.now());
      })

      myVideo.videoTracks.addEventListener('addtrack', (e) => {
        console.log(e.type, performance.now());
      })

      myVideo.videoTracks.addEventListener('removetrack', (e) => {
        console.log(e.type, performance.now());
      })

      myVideo.addEventListener('play', function(event) {
        console.log(event.type);

        console.log(myVideo.videoTracks)
        console.log(myVideo.audioTracks);

        console.log(myVideo.videoTracks[0]);
        console.log(myVideo.audioTracks[0]);

        console.log(myVideo.videoTracks[0].renditions[0]);
        // console.log(Object.getPrototypeOf(myVideo.videoTracks[0]))
      });

      setTimeout(() => {
        myVideo.removeAttribute('src');
        myVideo.load();
      }, 5000);

    </script>

  </body>
</html>
